<html>
<head>
  <title>vlan间路由</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="648"/>
<h1>vlan间路由</h1>

<div>
<span><div>vlan间路由</div><div>vlan间路由必须经过三成设备，可以是路由器或者三层交换机</div><div><br/></div><div>路由器-单臂路由</div><div><br/></div><div><br/></div><div><img src="vlan间路由_files/Image.png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>这里仅演示单臂路由的配置，其他vlan、接口配置参考 <a href="思科交换机vlan配置.html" style="color: rgb(105, 170, 53);">思科交换机vlan配置</a></div><div><br/></div><div>单臂路由</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">Sw2&gt;enable</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">Sw2#configure terminal</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">Sw2(config)#interface fastEthernet 0/23</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">Sw2(config-if)#switchport mode trunk</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">Sw2(config-if)#no shutdown</span></div><div><br/></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">R1&gt;enable</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">R1#configure t</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">R1(config)#interface fastEthernet 0/0.10</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">R1(config-subif)#ip address 172.16.10.254 255.255.255.0</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51); background-color: rgb(255, 250, 165);-evernote-highlight:true;">R1(config-subif)#encapsulation dot1Q 10             ##10为vlan ID</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">R1(config-subif)#exit</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">R1(config)#</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">R1(config)#interface fastEthernet 0/0.20</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">R1(config-subif)#encapsulation dot1Q 20</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">R1(config-subif)#ip address 172.16.20.254 255.255.255.0</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">R1(config-subif)#</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">R1(config-subif)#end</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">R1#</span></div></div><div><br/></div><div>想要互通还需要在pc上配置网关，vlan10的配置为172.16.10.254，vlan20的配置为172.16.20.254</div><div><br/></div><div><br/></div><div>三层交换机</div><div><img src="vlan间路由_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div>这里仅演示三层交换机的配置，其他vlan、接口配置参考 <a href="思科交换机vlan配置.html" style="color: rgb(105, 170, 53);">思科交换机vlan配置</a></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div style="margin: 0px; text-indent: 0px;"><b>与三层交换机连接的端口需要时trunk口</b></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">Switch9(config)#interface fastEthernet 0/23</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">Switch9(config-if)#switchport mode trunk</span></div><div><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">Switch9(config-if)#no shutdown</span></div><div><br/></div><div><br/></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch&gt;enable</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch#configure t</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config)#<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">ip routing</span></span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config)#interface fastEthernet 0/24</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config-if)#switchport trunk encapsulation dot1q</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config-if)#switchport mode trunk</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config-if)#exit</span></div><div style="margin: 0px; text-indent: 0px;"><br/></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config)#</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config)#vlan 10</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config-vlan)#name HR</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config-vlan)#exit</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config)#</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config)#vlan 20</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config-vlan)#name SALES</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config-vlan)#exit</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config)#</span></div><div style="margin: 0px; text-indent: 0px;"><br/></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config)#interface vlan 10</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config-if)#ip address 192.168.10.254 255.255.255.0</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config-if)#no shutdown</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config-if)#exit</span></div><div style="margin: 0px; text-indent: 0px;"><br/></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config)#interface vlan 20</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config-if)#ip address 192.168.20.254 255.255.255.0</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config-if)#no shutdown</span></div><div style="margin: 0px; text-indent: 0px;"><span style="text-indent: 0px; font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">L3Switch(config-if)#</span></div></div><div><br/></div><div>配置完成后，pc需要指到相应的网关，vlan10的为192.168.10.254，vlan20的为192.168.20.254</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 