<html>
<head>
  <title>类对象特殊方法——__getattr__()、__getitem__()、__setitem__()、__delitem__()</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="780"/>
<h1>类对象特殊方法——__getattr__()、__getitem__()、__setitem__()、__delitem__()</h1>

<div>
<span><div><span style="font-weight: bold;">类对象特殊方法——__getattr__()、__getitem__()、__setitem__()、__delitem__()</span></div><div><br/></div><div><span style="font-weight: bold;">__getattr__()</span></div><div>当访问实例对象的属性或方法时，如果指定的属性或方法不存在，就会抛出AttributeError，为了避免抛出此异常，可以在实例对象所对应的类对象中实现特殊方法__getattr__()，这样，当指定的属性或方法不存在时，就会自动调用特殊方法__getattr__()。</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 0, 255); font-size: 9pt;">#!/usr/bin/python3</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(200, 175, 0); font-size: 9pt;">class</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 205, 205); font-size: 9pt;">MyClass</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">(</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 205, 205); font-size: 9pt;">object</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">):</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">   </span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(200, 175, 0); font-size: 9pt;">def</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 205, 205); font-size: 9pt;">do_sth</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">(self):</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">       </span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 205, 205); font-size: 9pt;">print</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">(</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">'do_sth()被调用了'</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">)</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">   </span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(200, 175, 0); font-size: 9pt;">def</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 205, 205); font-size: 9pt;">__getattr__</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">(self, name):</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">       </span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(200, 175, 0); font-size: 9pt;">if</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">name ==</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">'data'</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">:                     <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 0, 255); font-size: 9pt;"># 判断的是属性名,</span></span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">           </span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(200, 175, 0); font-size: 9pt;">return</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">20                          <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 0, 255); font-size: 9pt;"># 返回的是属性值</span></span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">       </span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(200, 175, 0); font-size: 9pt;">elif</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">name ==</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">'do_sth1'</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">:                <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 0, 255); font-size: 9pt;"># 判断的是方法名</span></span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">           </span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(200, 175, 0); font-size: 9pt;">return</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 205, 205); font-size: 9pt;">print                       <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 0, 255); font-size: 9pt;"># 返回的是方法名</span></span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">       </span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(200, 175, 0); font-size: 9pt;">else</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">:</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">           </span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(200, 175, 0); font-size: 9pt;">raise</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 100, 0); font-size: 9pt;">AttributeError</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">(</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">'__getattr__()被调用了'</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">)      <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 0, 255); font-size: 9pt;"># 都不匹配的话，就自定义异常</span></span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">mc = MyClass()</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">mc.do_sth()                     <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 0, 255); font-size: 9pt;"># 这里找到了do_sth方法，直接进行调用</span></span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 0, 255); font-size: 9pt;"># 下面的属性或方法都不存在，因此调用特殊方法__getattr__()，属性名和方法名被当做实参传入，进而进行匹配，当这里都没有的时候，才抛出异常</span></div><div><br/></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 205, 205); font-size: 9pt;">print</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">(mc.data)                  <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 0, 255); font-size: 9pt;"># 这里匹配到了data属性名，返回的就是20</span></span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">mc.do_sth1(</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">'hello'</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">)             <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 0, 255); font-size: 9pt;"># 这里匹配到了do_sth1，返回的是print函数，那么do_sth1就可以被当做print来调用</span></span></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">[root@lyucan ~]# ./28.py</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">do_sth()被调用了</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">20</span></div><div><font color="#008000" face="DejaVu Sans Mono">hello</font></div></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">__getitem__()、<span style="font-weight: bold;">__setitem__()、<span style="font-weight: bold;">__delitem__()</span></span></span></div><div>对于自定义类对象的实例对象，在默认情况下，是不能像列表和字典那样使用中括号语法来操作数据的。</div><div><br/></div><div>如果想让自定义类对象的实例对象可以像列表和字典那样使用[]语法操作数据，必须在自定义类对象中实现以下三个特殊方法：</div><div>1、__getitem__(self, key)</div><div>        当执行操作“obj[key]”时，会自动调用该特殊方法。</div><div><br/></div><div>2、__setitem__(self, key, value)</div><div>        当执行操作“obj[key] = value”时，会自动调用该特殊方法。</div><div><br/></div><div>3、__delitem__(self, key)</div><div>        当执行操作“del obj[key]”时，会自动调用该他特殊方法。</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 0, 255); font-size: 9pt;">#!/usr/bin/python3</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(200, 175, 0); font-size: 9pt;">class</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 205, 205); font-size: 9pt;">MyClass</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">(</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 205, 205); font-size: 9pt;">object</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">):</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">   </span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(200, 175, 0); font-size: 9pt;">def</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 205, 205); font-size: 9pt;">__init__</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">(self):</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">        self.data = {}</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">   </span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(200, 175, 0); font-size: 9pt;">def</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 205, 205); font-size: 9pt;">__getitem__</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">(self, key):</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">       </span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(200, 175, 0); font-size: 9pt;">return</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">self.data[key]</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">   </span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(200, 175, 0); font-size: 9pt;">def</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 205, 205); font-size: 9pt;">__setitem__</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">(self, key, value):</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">        self.data[key] = value</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">   </span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(200, 175, 0); font-size: 9pt;">def</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 205, 205); font-size: 9pt;">__delitem__</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">(self, key):</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">       </span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(200, 175, 0); font-size: 9pt;">del</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">self.data[key]</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">mc = MyClass()</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">mc[</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">'name'</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">] =</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">'Jerry'</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">mc[</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">'age'</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">] =</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">25</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 205, 205); font-size: 9pt;">print</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">(mc[</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">'name'</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">])</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 205, 205); font-size: 9pt;">print</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">(mc[</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">'age'</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">])</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(200, 175, 0); font-size: 9pt;">del</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">mc[</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">'age'</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">]</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 205, 205); font-size: 9pt;">print</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">(mc[</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">'age'</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">])</span></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">[root@lyucan ~]# ./29.py</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">Jerry</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">25</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">Traceback (most recent call last):</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">  File &quot;./29.py&quot;, line 27, in &lt;module&gt;</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">    print(mc['age'])</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">  File &quot;./29.py&quot;, line 8, in __getitem__</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">    return self.data[key]</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">KeyError: 'age'</span></div></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 