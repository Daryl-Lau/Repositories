<html>
<head>
  <title>事务</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="404"/>
<h1>事务</h1>

<div>
<span><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-indent: 28px; text-align: left; font-size: 14px;"><span style="font-size: 14px; text-indent: 28px; white-space: pre-wrap; line-height: 1.75;">事务</span></div><div style="white-space: pre-wrap; text-indent: 56px; text-align: left; font-size: 14px;"><span style="font-size: 14px; text-indent: 56px; white-space: pre-wrap; line-height: 1.75;">ACID特性</span></div><div style="white-space: pre-wrap; text-indent: 56px; text-align: left; font-size: 14px;"><span style="font-size: 14px; text-indent: 56px; white-space: pre-wrap; line-height: 1.75;">隔离级别</span></div><div style="white-space: pre-wrap; text-indent: 56px; text-align: left; font-size: 14px;"><span style="font-size: 14px; text-indent: 56px; white-space: pre-wrap; line-height: 1.75;">事务控制语句</span></div><div style="white-space: pre-wrap; text-indent: 56px; text-align: left; font-size: 14px;"><span style="font-size: 14px; text-indent: 56px; white-space: pre-wrap; line-height: 1.75;">隐式提交的sql语句</span></div><div style="white-space: pre-wrap; text-indent: 56px; text-align: left; font-size: 14px;"><span style="font-size: 14px; text-indent: 56px; white-space: pre-wrap; line-height: 1.75;">Redo log</span></div><div style="white-space: pre-wrap; text-indent: 56px; text-align: left; font-size: 14px;"><span style="font-size: 14px; text-indent: 56px; white-space: pre-wrap; line-height: 1.75;">Undo log</span></div><div style="white-space: pre-wrap; text-indent: 28px; text-align: left; font-size: 14px;"><span style="font-size: 14px; text-indent: 28px; white-space: pre-wrap; line-height: 1.75;">innodb存储引擎中的锁</span></div><div style="white-space: pre-wrap; text-indent: 56px; text-align: left; font-size: 14px;"><span style="font-size: 14px; text-indent: 56px; white-space: pre-wrap; line-height: 1.75;">锁的类型</span></div><div style="white-space: pre-wrap; text-indent: 56px; text-align: left; font-size: 14px;"><span style="font-size: 14px; text-indent: 56px; white-space: pre-wrap; line-height: 1.75;">锁的算法</span></div><div style="white-space: pre-wrap; text-indent: 56px; text-align: left; font-size: 14px;"><span style="font-size: 14px; text-indent: 56px; white-space: pre-wrap; line-height: 1.75;">一致性非锁定读</span></div><div style="white-space: pre-wrap; text-indent: 56px; text-align: left; font-size: 14px;"><span style="font-size: 14px; text-indent: 56px; white-space: pre-wrap; line-height: 1.75;">一致性锁定读</span></div><div style="white-space: pre-wrap; text-indent: 56px; text-align: left; font-size: 14px;"><span style="font-size: 14px; text-indent: 56px; white-space: pre-wrap; line-height: 1.75;">外键锁</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 20px; font-weight: bold; line-height: 1.75;">事务</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 16px; font-weight: bold; line-height: 1.75;">ACID特性</span></div><div style="white-space: pre-wrap; text-indent: 28px; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; text-indent: 28px; font-size: 14px; line-height: 1.75;">事务是数据库区别于文件系统的重要特性之一,事务会把数据库从一种一致状态转换为另一种一致状态.在数据库提交工作时，可以确保其要么所有修改都已经保存，要么所有修改都不保存。</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">Innodb存储引擎中的事务完全符合ACID的特性：</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">1、原子性（atomicity）：原子性是指整个数据库事务是不可分割的工作单位.只有使事务中所有的数据库操作执行都成功，才算整个事务成功.如果事务中任何一个sql语句执行失败，那么已经执行成功的sql语句也必须撤销,数据库状态应该退回到执行事务前的状态.</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">2、一致性（consistency）：一致性是指事务将数据库从一种状态转变为下一种一致的状态，在事务开始之前和事务结束以后，数据库的完整性约束没有被破坏.</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">3、隔离性（isolation）：一个事务的影响在该事务提交前对其他事务都不可见</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">4、持久性（durability）：事务一旦提交，其结果就是永久性.</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 16px; font-weight: bold; line-height: 1.75;">隔离级别</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">Sql标准定义的四个隔离级别：</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">1、未提交读（Read uncommitted）</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">2、提交读（Read committed）</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">3、可重复读（Repeatable read）</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">4、串行化（Serializable）</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;"><br/></span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">mysql默认为repeatable read</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">oracle默认为read committed</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;"><br/></span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">设置隔离级别</span></div><div style="text-align: left; float: none;"><div><img src="事务_files/Image.png" type="image/png" data-filename="Image.png"/></div></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 16px; font-weight: bold; line-height: 1.75;">事务控制语句</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="text-indent: 28px; font-size: 14px;">    Mysql命令行的默认设置下，事务都是自动提交的,即执行sql语句后就会马上执行commit操作.因此开始一个事务，必须使用begin,start transaction,或者执行set autocommit=0,以禁用当前会话的自动提交；</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">Start transaction | begin：显示地开启一个事务</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">Commit：提交事务，并使得已对数据库做的所有修改成为永久性.</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">Rollback：回滚事务，撤销正在进行的所有未提交的修改.</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 16px; font-weight: bold; line-height: 1.75;">隐式提交的sql语句</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">某些Sql语句会产生一个隐式的提交操作,即执行完这些语句后，会有一个隐式的commit操作；</span></div><div style="text-align: left; float: none;"><img src="file:///D:/youdao/localfile/liuyi930714@163.com/21d7b27afdb0436c858e4833cef306da/clipboard.png"></img><img src="事务_files/Image [1].png" type="image/png" data-filename="Image.png"/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; color: rgb(223, 64, 42); line-height: 1.75;">注意点：Truncate table 语句是DDL，虽然和delete整张表的结果一样，但它不能被回滚</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 16px; font-weight: bold; line-height: 1.75;">Redo log</span></div><div style="white-space: pre-wrap; text-indent: 28px; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; text-indent: 28px; font-size: 14px; line-height: 1.75;">在innodb存储引擎中，事务日志通过重做（redo）日志文件和innodb存储引擎的日志缓冲来实现，当开始一个事务时，会记录该事务的一个lSN;当事务执行时，会往innodb存储引擎的日志缓冲里插入事务日志;当事务提交时，必须将innodb存储引擎的日志缓冲写入磁盘,也就是写数据前，需要先写日志.称为预写日志方式（WAL）；</span></div><div style="white-space: pre-wrap; text-indent: 28px; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; text-indent: 28px; font-size: 14px; line-height: 1.75;">Innodb存储引擎通过预写日志的方式，来保证事务的完整性.这意味着磁盘上存储的数据页和内存缓冲池中的页是不同步的,对于内存缓冲池中页的修改，先是写入重做日志文件，然后再写入磁盘，是一种异步方式.；</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">Log sequence number 表示当前的LSN</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">Log flushed up to 表示刷新到重做日志文件的LSN</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">Last checkpoint at表示刷新到磁盘的lSN</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">Pages flushed up to 刷新事务和提交后的LSN（新添加的参数）</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 16px; font-weight: bold; line-height: 1.75;">Undo log</span></div><div style="white-space: pre-wrap; text-indent: 28px; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; text-indent: 28px; font-size: 14px; line-height: 1.75;">重做日志记录了事务的行为，可以很好地通过其进行重做，但是事务有时还需要撤销，这时就需要undo.undo与redo正好相反，对于数据库进行修改时，数据库不但产生redo，而且还会产生一定量的undo，即使你执行的事务或语句由于某种原因失败了，或者如果你用一条rollback语句请求回滚,就可以利用这些undo信息将数据回滚到修改之前的样子.与redo不同的是，redo存放在重做日志文件中，undo存放在数据库内部的一个特殊段中，undo segment.undo段位于共享表空间内;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 20px; font-weight: bold; line-height: 1.75;">innodb存储引擎中的锁</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 16px; font-weight: bold; line-height: 1.75;">锁的类型</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">共享锁（S） ： 允许事务读一行数据</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">排他锁(X) ： 允许事务删除或更新一条数据</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">意向共享锁（IS）： 事务想要获取一张表中某几行的共享锁</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">意向排他锁（IX）： 事务想要获取一张表中某几行的排他锁</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">兼容性（Y：兼容，N：不兼容）</span></div><div style="font-size: 14px; width: 100%; overflow: auto;"><div><br/></div><table border="1" cellpadding="0" cellspacing="0" style="table-layout:fixed;border-collapse:collapse;border:1px solid #ccc;width:620px"><colgroup><col style="width: 124px;"></col><col style="width: 124px;"></col><col style="width: 124px;"></col><col style="width: 124px;"></col><col style="width: 124px;"></col></colgroup><tbody><tr style="height: 40px;"><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><br/></div></td><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">S</span></div></td><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">X</span></div></td><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">IS</span></div></td><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">IX</span></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">S</span></div></td><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">Y</span></div></td><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">N</span></div></td><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">Y</span></div></td><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">N</span></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">X</span></div></td><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">N</span></div></td><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">N</span></div></td><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">N</span></div></td><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">N</span></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">IS</span></div></td><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">Y</span></div></td><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">N</span></div></td><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">Y</span></div></td><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">Y</span></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">IX</span></div></td><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">N</span></div></td><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">N</span></div></td><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">Y</span></div></td><td style="word-wrap: break-word; text-align: center; white-space: normal;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">Y</span></div></td></tr></tbody></table><div><br/></div></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 16px; font-weight: bold; line-height: 1.75;">锁的算法</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">Record Lock：单行记录上上锁</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">Gap Lock：间隙锁，锁定一个范围，但不包含记录本身</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">Next-key Lock：Record Lock + Gap Lock，锁定一个范围，并锁定记录本身，目的是为了解决幻读现象</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 16px; font-weight: bold; line-height: 1.75;">一致性非锁定读</span></div><div style="white-space: pre-wrap; text-indent: 28px; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; text-indent: 28px; font-size: 14px; line-height: 1.75;">一致性非锁定读是值InnoDB存储引擎通过多版本控制（multi versioning）的方式来读取当前执行时间数据库中的数据。如果被读的数据行被加了排他锁，在读取这行数据的时候并不会等待锁释放，而是读取该行的一个快照数据。</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">        之所以称为非锁定读，因为不需要等待被访问行的X锁的释放。快照数据是指改行之前的数据版本，该实现通过undo段来完成。</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">        非锁定读的方式极大提高了数据库的并发性。在InnoDB存储引擎中，这是默认的读取方式。</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">        快照数据其实就是当前行数据的一个历史版本，每行记录可能有多个版本。这种技术成为行多版本技术。由此带来的并发控制，成为多版本并发控制（Multi Version Concurrency Control,MVCC）。</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">        在事务的隔离级别，READ COMMITED和REPEATABLE READ下，对快照数据的定义不同。在READ COMMITTED事务隔离级别下，对于快照数据，非一致性读总是读取被锁定行的最新一份快照数据。而在REPEATABLE READ事务隔离级别下，对于快照数据，非一致性读总是读取事务开始时的数据版本。</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">        也就是说在READ COMMITTED事务隔离级别下，非锁定读读取到的数据是最新的快照版本数据，也就是可以读到另一个事务已经提交了的快照数据。而在REPEATABLE READ下，只会读到事务开始前的数据。</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 16px; font-weight: bold; line-height: 1.75;">一致性锁定读</span></div><div style="white-space: pre-wrap; text-indent: 28px; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; text-indent: 28px; font-size: 14px; line-height: 1.75;">  在默认情况下，InnoDB存储引擎对数据采用的是一致性非锁定读。但是有些情况下为了保证数据逻辑的一致性，需要对SELECT的操作加锁。InnoDB存储引擎对于SELECT语句支持两种一致性的锁定读（locking read）操作：</span></div><div style="white-space: pre-wrap; text-indent: 28px; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; text-indent: 28px; font-size: 14px; line-height: 1.75;">1、  SELECT …… FOR UPDATE</span></div><div style="white-space: pre-wrap; text-indent: 28px; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; text-indent: 28px; font-size: 14px; line-height: 1.75;">2、  SELECT …… LOCK IN SHARE MODE</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">　　其中，SELECT …… FOR UPDATE对读取的记录加一个X锁，其他事务不能对已锁定的行加任何锁。而SELECT …… LOCK IN SHARE MODE是对读取的记录加一个S锁。</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">　　即使被读取的行被加了一致性锁定读，如果有另一个一致性非锁定读的操作来读取该行数据是不会阻塞的，读取的是该行的快照版本。</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">　　SELECT …… FOR UPDATE和SELECT …… LOCK IN SHARE MODE必须在一个事务中，当一个事务提交了，锁就释放了。因此在使用上述两个SELECT锁定语句时，必须开启事务。</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; color: rgb(223, 64, 42); line-height: 1.75;">关于一致性非锁定读和一致性锁定读自己的理解：</span></div><div style="white-space: pre-wrap; text-indent: 28px; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; text-indent: 28px; font-size: 14px; color: rgb(223, 64, 42); line-height: 1.75;">一致性非锁定读情况下，事务A进行了select操作，此时事务B可以对事务A select的行进行update操作，此时事务A再次进行select操作，读取到的结果和事务的隔离级别有关，如果是repeatable read级别，不论事务B有没有进行commit操作，事务A此时查询到的结果还是第一次的结果，如果是read committed级别，若事务B没有提交，此时查询到的结果还是第一次的结果，若事务B提交了，此时查询到的结果就会是事务B更新之后的结果。</span></div><div style="white-space: pre-wrap; text-indent: 28px; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; text-indent: 28px; font-size: 14px; color: rgb(223, 64, 42); line-height: 1.75;">一致性锁定读情况下，事务B无法对事务A select的行进行update操作。</span></div><div style="font-size: 14px; width: 100%; overflow: auto;"><div><br/></div><table border="1" cellpadding="0" cellspacing="0" style="table-layout:fixed;border-collapse:collapse;border:1px solid #ccc;width:620px"><colgroup><col style="width: 48px;"></col><col style="width: 262px;"></col><col style="width: 308px;"></col></colgroup><tbody><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">步骤</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; color: rgb(223, 64, 42); font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">事务A（repeatable-read）</span></div><div><span style="font-size: 14px; color: rgb(223, 64, 42); font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">SET @@tx_isolation='repeatable-read'</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; color: rgb(223, 64, 42); font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">事务B</span></div><div><span style="font-size: 14px; color: rgb(223, 64, 42); font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">SET @@tx_isolation='repeatable-read'</span></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">1</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">begin;</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">2</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">select * from users where user_id=1;</span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">user_id   name </span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">1             李四</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">3</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">begin；</span></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">4</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">update users set name=‘张三’ where user_id=1;</span></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">5</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">select * from users where user_id=1;</span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">user_id   name </span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">1             李四</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">6</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">commit;</span></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">7</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">select * from users where user_id=1;</span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">user_id   name </span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">1             李四</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">8</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">commit;</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">9</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">select * from users where user_id=1;</span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">user_id   name </span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">1             张三</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td></tr></tbody></table><div><br/></div></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="font-size: 14px; width: 100%; overflow: auto;"><div><br/></div><table border="1" cellpadding="0" cellspacing="0" style="table-layout:fixed;border-collapse:collapse;border:1px solid #ccc;width:620px"><colgroup><col style="width: 48px;"></col><col style="width: 262px;"></col><col style="width: 308px;"></col></colgroup><tbody><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">步骤</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; color: rgb(223, 64, 42); font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">事务A（read-committed）幻读</span></div><div><span style="font-size: 14px; color: rgb(223, 64, 42); font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">SET @@tx_isolation='read-committed'</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; color: rgb(223, 64, 42); font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">事务B</span></div><div><span style="font-size: 14px; color: rgb(223, 64, 42); font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">SET @@tx_isolation='read-committed'</span></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">1</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">begin;</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">2</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">select * from users where user_id=1;</span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">user_id   name </span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">1             李四</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">3</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">begin；</span></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">4</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">update users set name=‘张三’ where user_id=1;</span></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">5</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">select * from users where user_id=1;</span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">user_id   name </span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">1             李四</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">6</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">commit;</span></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">7</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">select * from users where user_id=1;</span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">user_id   name </span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">1             张三</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">8</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">commit;</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">9</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">select * from users where user_id=1;</span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">user_id   name </span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">1             张三</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td></tr></tbody></table><div><br/></div></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="font-size: 14px; width: 100%; overflow: auto;"><div><br/></div><table border="1" cellpadding="0" cellspacing="0" style="table-layout:fixed;border-collapse:collapse;border:1px solid #ccc;width:620px"><colgroup><col style="width: 48px;"></col><col style="width: 265px;"></col><col style="width: 305px;"></col></colgroup><tbody><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">步骤</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; color: rgb(223, 64, 42); font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">事务A（read-uncommitted ）脏读</span></div><div><span style="font-size: 14px; color: rgb(223, 64, 42); font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">SET @@tx_isolation='read-uncommitted'</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">事务B</span></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">1</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">begin;</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">2</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">select * from users where user_id=1;</span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">user_id   name </span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">1             李四</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">3</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">begin；</span></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">4</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">update users set name=‘张三’ where user_id=1;</span></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">5</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">select * from users where user_id=1;</span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">user_id   name </span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">1             张三</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">6</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">commit;</span></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">7</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">select * from users where user_id=1;</span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">user_id   name </span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">1             张三</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">8</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">commit;</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td></tr><tr style="height: 40px;"><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">9</span></div></td><td style="word-wrap: break-word;"><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">select * from users where user_id=1;</span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">user_id   name </span></div><div><span style="font-size: 14px; font-family: -apple-system, BlinkMacSystemFont, &quot;PingFang SC&quot;, Helvetica, Tahoma, Arial, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, 微软雅黑, SimSun, 宋体, Heiti, 黑体, sans-serif;">1             张三</span></div></td><td style="word-wrap: break-word;"><div><br/></div></td></tr></tbody></table><div><br/></div></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 16px; font-weight: bold; line-height: 1.75;">外键锁</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">        对于外键值的插入和更新，首先需要查找父表中的记录，即SELECT父表。但是对于父表的SELECT操作，不是采用一致性非锁定读的方式，因为这样可能会发生数据不一致的问题。此时采用过的是SELECT …… LOCK IN SHARE MODE的方式，给父表的记录加一个S锁。如果此时对父表加一个X锁，则会被阻塞。</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 20px; font-weight: bold; line-height: 1.75;">事务和锁最重要的三张表</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">在information_schema下，有三张表记录了事务和锁的信息：</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">INNODB_TRX</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">INNODB_LOCKS</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">INNODB_LOCK_WAITS</span></div><div><br/></div></span>
</div></body></html> 