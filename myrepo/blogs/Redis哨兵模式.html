<html>
<head>
  <title>Redis哨兵模式</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="402"/>
<h1>Redis哨兵模式</h1>

<div>
<span><div>Redis哨兵模式</div><div><br/></div><div>环境</div><div><div><br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 130px;"></col><col style="width: 130px;"></col><col style="width: 130px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>角色</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>IP</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>端口</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>master</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>10.10.10.100</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>6379</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>slave1</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>10.10.10.101</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>6379</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>slave2</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>10.10.10.102</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>6379</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;">sentinel</td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>10.10.10.100</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>26379</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>sentinel</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>10.10.10.101</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>26379</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>sentinel</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>10.10.10.102</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 130px; padding: 8px;"><div>26379</div></td></tr></tbody></table><div>主从复制配置很简单，不做赘述</div></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;"><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">10.10.10.100:6379</span>&gt; info replication</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;"># Replication</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">role:master</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">connected_slaves:2</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">slave0:ip=10.10.10.101,port=6379,state=online,offset=5695,lag=1</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">slave1:ip=10.10.10.102,port=6379,state=online,offset=5695,lag=0</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">master_replid:ed0b450585c5395c1eebce8eb8b5273df35463ca</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">master_replid2:0000000000000000000000000000000000000000</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">master_repl_offset:5695</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">second_repl_offset:-1</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">repl_backlog_active:1</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">repl_backlog_size:1048576</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">repl_backlog_first_byte_offset:1</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">repl_backlog_histlen:5695</span></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;"><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">10.10.10.101:6379</span>&gt; info replication</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;"># Replication</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">role:slave</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">master_host:10.10.10.100</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">master_port:6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">master_link_status:up</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">master_last_io_seconds_ago:9</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">master_sync_in_progress:0</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">slave_repl_offset:5737</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">slave_priority:100</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">slave_read_only:1</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">connected_slaves:0</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">master_replid:ed0b450585c5395c1eebce8eb8b5273df35463ca</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">master_replid2:0000000000000000000000000000000000000000</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">master_repl_offset:5737</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">second_repl_offset:-1</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">repl_backlog_active:1</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">repl_backlog_size:1048576</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">repl_backlog_first_byte_offset:1</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">repl_backlog_histlen:5737</span></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;"><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">10.10.10.102:6379</span>&gt; info replication</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;"># Replication</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">role:slave</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">master_host:10.10.10.100</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">master_port:6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">master_link_status:up</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">master_last_io_seconds_ago:4</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">master_sync_in_progress:0</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">slave_repl_offset:5807</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">slave_priority:100</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">slave_read_only:1</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">connected_slaves:0</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">master_replid:ed0b450585c5395c1eebce8eb8b5273df35463ca</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">master_replid2:0000000000000000000000000000000000000000</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">master_repl_offset:5807</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">second_repl_offset:-1</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">repl_backlog_active:1</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">repl_backlog_size:1048576</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">repl_backlog_first_byte_offset:1523</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">repl_backlog_histlen:4285</span></div></div><div><br/></div><div>复制一份安装包里面的配置文件sentinel.conf，修改以下master配置即可</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="min-height: 13pt; font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">sentinel monitor mymaster 10.10.10.100 6379 2</span></div><div><br/></div><div><span style="min-height: 13pt; font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">##mymaster名字随便取，但是需要保持一致</span></div><div><span style="min-height: 13pt; font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">## 2 表示获取的票数，有三台哨兵，2台及2台以上认为master挂掉了，才进行切换，这个值需要大于哨兵总数的一半</span></div></div><div><br/></div><div>注意！！哨兵模式在配置的时候，如果<span style="color: rgb(227, 0, 0);">三个哨兵启动在不同的机器</span>，需要配置bind IPADDR ，否则哨兵将不起作用</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(11, 133, 255); font-size: 11pt;"># *** <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">IMPORTANT</span> ***</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(11, 133, 255); font-size: 11pt;">#</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;;color: rgb(11, 133, 255);font-size: 11pt;background-color: rgb(255, 250, 165);-evernote-highlight:true;"># By default Sentinel will not be reachable from interfaces different than</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;;color: rgb(11, 133, 255);font-size: 11pt;background-color: rgb(255, 250, 165);-evernote-highlight:true;"># localhost, either use the 'bind' directive to bind to a list of network</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;;color: rgb(11, 133, 255);font-size: 11pt;background-color: rgb(255, 250, 165);-evernote-highlight:true;"># interfaces, or disable protected mode with &quot;protected-mode no&quot; by</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;;color: rgb(11, 133, 255);font-size: 11pt;background-color: rgb(255, 250, 165);-evernote-highlight:true;"># adding it to this configuration file.</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(11, 133, 255); font-size: 11pt;">#</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(11, 133, 255); font-size: 11pt;"># Before doing that MAKE SURE the instance is protected from the outside</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(11, 133, 255); font-size: 11pt;"># world via firewalling or other means.</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(11, 133, 255); font-size: 11pt;">#</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(11, 133, 255); font-size: 11pt;"># For example you may use one of the following:</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(11, 133, 255); font-size: 11pt;">#</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(11, 133, 255); font-size: 11pt;"># bind 127.0.0.1 192.168.1.1</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(11, 133, 255); font-size: 11pt;">#</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(11, 133, 255); font-size: 11pt;"># protected-mode no</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(11, 133, 255); font-size: 11pt;"># port &lt;sentinel-port&gt;</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(11, 133, 255); font-size: 11pt;"># The port that this sentinel instance will run on</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">bind 10.10.10.100</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">port 26379</span></div></div><div><br/></div><div>如果不配置bind，将会出现以下现象，会自动断开其他哨兵的连接</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12642:X 31 May 14:03:12.133 # Sentinel ID is 93f88deff364d6f6842540a85b6ad066b6e1c72d</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12642:X 31 May 14:03:12.133 # +monitor master mymaster 10.10.10.100 6379 quorum 2</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12642:X 31 May 14:03:12.133 * +slave slave 10.10.10.101:6379 10.10.10.101 6379 @ mymaster 10.10.10.100 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12642:X 31 May 14:03:12.134 * +slave slave 10.10.10.102:6379 10.10.10.102 6379 @ mymaster 10.10.10.100 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12642:X 31 May 14:03:17.880 * +sentinel sentinel f99e627401f6e23d1242c18764b8d820a63ef1b5 10.10.10.101 26379 @ mymaster 10.10.10.100 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12642:X 31 May 14:03:21.432 * +sentinel sentinel d9463b90bd223c6308969dc3a7c7ae7299f4cc93 10.10.10.102 26379 @ mymaster 10.10.10.100 6379</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;;color: rgb(0, 128, 0);font-size: 11pt;background-color: rgb(255, 250, 165);-evernote-highlight:true;">12642:X 31 May 14:03:47.904 # +sdown sentinel f99e627401f6e23d1242c18764b8d820a63ef1b5 10.10.10.101 26379 @ mymaster 10.10.10.100 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;;color: rgb(0, 128, 0);font-size: 11pt;background-color: rgb(255, 250, 165);-evernote-highlight:true;">12642:X 31 May 14:03:51.494 # +sdown sentinel d9463b90bd223c6308969dc3a7c7ae7299f4cc93 10.10.10.102 26379 @ mymaster 10.10.10.100 6379</span></div></div><div><br/></div><div>配置成功后会在配置文件后面添加主从信息和哨兵节点信息</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(11, 133, 255); font-size: 11pt;"># Generated by CONFIG REWRITE</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">sentinel known-slave mymaster 10.10.10.102 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">sentinel known-slave mymaster 10.10.10.101 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">sentinel known-sentinel mymaster 10.10.10.102 26379 d9463b90bd223c6308969dc3a7c7ae7299f4cc93</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">sentinel known-sentinel mymaster 10.10.10.101 26379 f99e627401f6e23d1242c18764b8d820a63ef1b5</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">sentinel current-epoch 4</span></div></div><div><br/></div><div><br/></div><div>把master down掉，观察是否会进行切换，三台哨兵，会选举出来一台进行切换动作</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:33.030 # +sdown master mymaster 10.10.10.100 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:33.097 # +odown master mymaster 10.10.10.100 6379 <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">#quorum 3/2</span></span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:33.097 # +new-epoch 5</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:33.097 # +try-failover master mymaster 10.10.10.100 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:33.098 # +vote-for-leader 93f88deff364d6f6842540a85b6ad066b6e1c72d 5</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:33.100 # d9463b90bd223c6308969dc3a7c7ae7299f4cc93 voted for 93f88deff364d6f6842540a85b6ad066b6e1c72d 5</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:33.100 # f99e627401f6e23d1242c18764b8d820a63ef1b5 voted for 93f88deff364d6f6842540a85b6ad066b6e1c72d 5</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:33.154 # +elected-leader master mymaster 10.10.10.100 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:33.154 # +failover-state-select-slave master mymaster 10.10.10.100 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:33.238 # +selected-slave slave 10.10.10.102:6379 10.10.10.102 6379 @ mymaster 10.10.10.100 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:33.238 * +failover-state-send-slaveof-noone slave 10.10.10.102:6379 10.10.10.102 6379 @ mymaster 10.10.10.100 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:33.310 * +failover-state-wait-promotion slave 10.10.10.102:6379 10.10.10.102 6379 @ mymaster 10.10.10.100 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:33.835 # +promoted-slave slave 10.10.10.102:6379 10.10.10.102 6379 @ mymaster 10.10.10.100 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:33.835 # +failover-state-reconf-slaves master mymaster 10.10.10.100 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:33.924 * +slave-reconf-sent slave 10.10.10.101:6379 10.10.10.101 6379 @ mymaster 10.10.10.100 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:34.242 # -odown master mymaster 10.10.10.100 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:34.886 * +slave-reconf-inprog slave 10.10.10.101:6379 10.10.10.101 6379 @ mymaster 10.10.10.100 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:34.886 * +slave-reconf-done slave 10.10.10.101:6379 10.10.10.101 6379 @ mymaster 10.10.10.100 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:34.940 # +failover-end master mymaster 10.10.10.100 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:34.940 # <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">+switch-master mymaster</span> 10.10.10.100 6379 10.10.10.102 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:34.940 * +slave slave 10.10.10.101:6379 10.10.10.101 6379 @ mymaster 10.10.10.102 6379</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:19:34.940 * +slave slave 10.10.10.100:6379 10.10.10.100 6379 @ mymaster 10.10.10.102 6379</span></div><div><span style="min-height: 13pt; font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 11pt;">12677:X 31 May 14:20:04.962 # +sdown slave 10.10.10.100:6379 10.10.10.100 6379 @ mymaster 10.10.10.102 6379</span></div></div><div><br/></div><div>三台哨兵，挂了一台可以继续工作，挂了两台就不行了，因为票数是2，如果票数是1的话，只有一台哨兵也是可以工作的</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></span>
</div></body></html> 