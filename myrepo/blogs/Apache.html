<html>
<head>
  <title>Apache</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="616"/>
<h1>Apache</h1>

<div>
<span><div>Apache</div><div><br/></div><div><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">/etc/httpd/conf/httpd.conf配置文件内容</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">ServerRoot &quot;/etc/httpd&quot;           ====&gt;指定httpd将在哪个位置中使用相对路径来查找配置文件</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">Listen 80                                    ====&gt;httpd监听在哪个端口，默认80/tcp，可以使用ipv4或者         ipv6，“1.2.3.4:80”(ipv4)，“[2001：db8：:1]:80”(ipv6)。</span> <span style="white-space: pre-wrap; font-size: 14px; color: rgb(255, 0, 0); line-height: 1.75;">注意如果使用了重复的listen指令，httpd服务将无法启动</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">Include conf.modules.d/*.conf  ====&gt;此指令包括其他文件，就如同这些文件插入到配置文件以代替            Include语句。如果指定了多个文件，将首先按字母顺序对文件进行排序。文件名可以使用绝对路径，也可以使用相对路径（相对于ServerRoot）,并且包括通配符。</span><span style="white-space: pre-wrap; font-size: 14px; color: rgb(255, 0, 0); line-height: 1.75;">注意指定不存在的文件名将导致httpd服务无法启动</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">User apache                              =====&gt;httpd服务的用户</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">Group apache                           =====&gt;httpd服务的组</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">ServerAdmin </span><a href="mailto:root@localhost" style="white-space: pre-wrap; font-size: 14px; color: rgb(0, 56, 132); line-height: 1.75; text-decoration: underline;">root@localhost</a><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">   =====&gt;生成错误页面可能包括一个连接，用户可以通过这个连接来报告问题，将此指令设置成为可用的电子邮箱，不建议设置成</span><a href="mailto:root@localhost" style="white-space: pre-wrap; font-size: 14px; color: rgb(0, 56, 132); line-height: 1.75; text-decoration: underline;">root@localhost</a></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">&lt;Directory /&gt;     ==============&gt;对目录进行的限制，可用的限制有</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    AllowOverride none        ======&gt; 对于按目录的配置设置，将不会查阅.htaccess文件</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    Require all denied           ======&gt;httpd将拒绝提供此目录的内容</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">&lt;/Directory&gt;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">DocumentRoot &quot;/var/www/html&quot;     =======&gt;此设置确定httpd将搜索请求文件的位置。</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">&lt;Directory &quot;/var/www&quot;&gt;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    AllowOverride None</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    Require all granted              ======&gt;允许访问此目录</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">&lt;/Directory&gt;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">&lt;Directory &quot;/var/www/html&quot;&gt;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    Options Indexes FollowSymLinks======&gt;定义目录下所有网页的访问属性，none（不支持任何选项），</span><span style="white-space: pre-wrap; font-size: 14px; background-color: rgb(255, 255, 255); line-height: 1.75;">Indexes（</span><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">索引，非常不安全，生产环境必须关掉，除非网站用于文件的下载），</span><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">FollowSymLinks（跟随符号链接，是否允许访问链接指向的源文件，），ExecCGI（允许运行CGI脚本），All（启用所有选项）</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    AllowOverride None ============&gt;是否允许覆盖，AuthConfig（基于用户的账号密码登录）</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    Order allow，deny  =============&gt;用于定义基于主机的访问功能的，IP,网络地址或主机定义访问控制，有先后顺序</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    Allow from all  ================&gt;允许所有访问</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    Require all granted</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">&lt;/Directory&gt;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">&lt;IfModule dir_module&gt;   =======&gt;仅当加载指定模块时，次块才会应用其内容。在此情况下，会加载dir_module，因此，</span><span style="white-space: pre-wrap; font-size: 14px; background-color: rgb(255, 255, 255); line-height: 1.75;">DirectoryIndex 指定可应用于指定在请求目录时应使用的文件。</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    DirectoryIndex index.html</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">&lt;/IfModule&gt;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">&lt;Files &quot;.ht*&quot;&gt;                     ======&gt;与Directory运行方式相同，此处使用了通配符，在此情况下，将阻止httpd提供任何安全性敏感的文件，如.htaccess和.htpasswd。</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    Require all denied</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">&lt;/Files&gt;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">ErrorLog &quot;logs/error_log&quot;  ======&gt;这指定httpd应将其遇到的错误记录到的文件，即错误日志</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">LogLevel warn</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">&lt;IfModule log_config_module&gt;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot;&quot; combined</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b&quot; common</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    &lt;IfModule logio_module&gt;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">      LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%{Referer}i\&quot; \&quot;%{User-Agent}i\&quot; %I %O&quot; combinedio</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    &lt;/IfModule&gt;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    CustomLog &quot;logs/access_log&quot; combined</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">&lt;/IfModule&gt;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">&lt;IfModule alias_module&gt;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    ScriptAlias /cgi-bin/ &quot;/var/www/cgi-bin/&quot;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">&lt;/IfModule&gt;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">&lt;Directory &quot;/var/www/cgi-bin&quot;&gt;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    AllowOverride None</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    Options None</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    Require all granted</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">&lt;/Directory&gt;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">&lt;IfModule mime_module&gt;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    TypesConfig /etc/mime.types</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    AddType application/x-compress .Z</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    AddType application/x-gzip .gz .tgz</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    AddHandler cgi-script .cgi .pl</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    AddType text/html .shtml</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    AddOutputFilter INCLUDES .shtml</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">&lt;/IfModule&gt;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">AddDefaultCharset UTF-8      </span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">&lt;IfModule mime_magic_module&gt;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">    MIMEMagicFile conf/magic</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">&lt;/IfModule&gt;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">EnableSendfile on</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">IncludeOptional conf.d/*.conf   ======&gt;与常规的include工作方式相同，但如果未找到文件，也不会生成错误</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">启服务</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">systemctl enable/start httpd.service</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">开端口</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">firewall-cmd --permanent --add-service=http --add-service=https</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 18px; font-weight: bold; line-height: 1.75;">虚拟主机的配置和故障排除</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">虚拟主机分很多种，有基于IP的虚拟主机，同个IP不同端口的虚拟主机，主机名的虚拟主机</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">虚拟主机允许单个httpd服务器为多个域提供内容。基于连接到的IP地址，http请求中客户端请求的主机名，或则这两者的组合，http可以使用不同的配置设置，包括不同的</span><span style="white-space: pre-wrap; font-size: 14px; background-color: rgb(255, 255, 255); line-height: 1.75;">DocumentRoot</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">虚拟主机是通过使用主配置中的&lt;VirtualHost &gt;块来配置的。为了方便管理，通常不会在/etc/httpd/conf/httpd.conf中定义这些虚拟主机块，而是在单独的/etc/httpd/conf.d/中单独的.conf文件中。</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">例如：</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">[</span><a href="mailto:root@redhata" style="white-space: pre-wrap; font-size: 14px; color: rgb(0, 56, 132); line-height: 1.75; text-decoration: underline;">root@redhata</a><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;"> ~]# vim /etc/httpd/conf.d/virtual.conf </span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 11pt;"><font color="#2D4FC9" face="DejaVu Sans Mono">##基于主机名的虚拟主机</font></span></div><div><span style="font-size: 11pt;"><font color="#000000" face="DejaVu Sans Mono">&lt;Directory &quot;/var/www/html&quot;&gt;</font></span></div><div><span style="font-size: 11pt;"><font color="#000000" face="DejaVu Sans Mono">     Require all granted</font></span></div><div><span style="font-size: 11pt;"><font color="#000000" face="DejaVu Sans Mono">&lt;/Directory&gt;</font></span></div><div><br style="font-size: 11pt;"/></div><div><br style="font-size: 11pt;"/></div><div><span style="font-size: 11pt;"><font color="#000000" face="DejaVu Sans Mono">&lt;VirtualHost *:80&gt;</font></span></div><div><font color="#000000" face="DejaVu Sans Mono"><span style="font-size: 11pt;">   ServerName  </span><a href="http://redhata.example.com/" style="font-size: 11pt; color: rgb(0, 0, 0);">redhata.example.com</a></font></div><div><span style="font-size: 11pt;"><font color="#000000" face="DejaVu Sans Mono">    DocumentRoot /var/www/html</font></span></div><div><span style="font-size: 11pt;"><font color="#000000" face="DejaVu Sans Mono">&lt;/VirtualHost&gt;</font></span></div><div><br style="font-size: 11pt;"/></div><div><br style="font-size: 11pt;"/></div><div><span style="font-size: 11pt;"><font color="#000000" face="DejaVu Sans Mono">&lt;Directory &quot;/var/www/www&quot;&gt;</font></span></div><div><span style="font-size: 11pt;"><font color="#000000" face="DejaVu Sans Mono">     Require all granted</font></span></div><div><span style="font-size: 11pt;"><font color="#000000" face="DejaVu Sans Mono">&lt;/Directory&gt;</font></span></div><div><br style="font-size: 11pt;"/></div><div><span style="font-size: 11pt;"><font color="#000000" face="DejaVu Sans Mono">&lt;VirtualHost *:80&gt;</font></span></div><div><font color="#000000" face="DejaVu Sans Mono"><span style="font-size: 11pt;">    ServerName  </span><a href="http://www.redhat.com/" style="font-size: 11pt; color: rgb(0, 0, 0);">www.redhat.com</a></font></div><div><span style="font-size: 11pt;"><font color="#000000" face="DejaVu Sans Mono">    DocumentRoot /var/www/www</font></span></div><div><span style="font-size: 11pt;"><font color="#000000" face="DejaVu Sans Mono">&lt;/VirtualHost&gt;</font></span></div><div><br/></div><div><span style="font-size: 11pt;"><font color="#2D4FC9" face="DejaVu Sans Mono">##基于IP的虚拟主机</font></span></div><div><font color="#000000"><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">&lt;</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">VirtualHost</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">172.20</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">.</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">30.40</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">:</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">80</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">&gt;</span></font></div><div><font color="#000000"><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">    ServerAdmin</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">webmaster@www1</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">.</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">example</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">.</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">com</span></font></div><div><font color="#000000"><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">    DocumentRoot</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">&quot;/www/vhosts/www1&quot;</span></font></div><div><font color="#000000"><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">    ServerName</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">www1</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">.</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">example</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">.</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">com</span></font></div><div><font color="#000000"><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">    ErrorLog</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">&quot;/www/logs/www1/error_log&quot;</span></font></div><div><font color="#000000"><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">    CustomLog</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">&quot;/www/logs/www1/access_log&quot;</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">combined</span></font></div><div><font color="#000000"><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">&lt;/</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">VirtualHost</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">&gt;</span></font></div><div><br style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;"/></div><div><font color="#000000"><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">&lt;</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">VirtualHost</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">172.20</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">.</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">30.50</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">:</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">80</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">&gt;</span></font></div><div><font color="#000000"><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">    ServerAdmin</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">webmaster@www2</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">.</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">example</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">.</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">org</span></font></div><div><font color="#000000"><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">    DocumentRoot</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">&quot;/www/vhosts/www2&quot;</span></font></div><div><font color="#000000"><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">    ServerName</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">www2</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">.</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">example</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">.</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">org</span></font></div><div><font color="#000000"><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">    ErrorLog</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">&quot;/www/logs/www2/error_log&quot;</span></font></div><div><font color="#000000"><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">    CustomLog</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">&quot;/www/logs/www2/access_log&quot;</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">combined</span></font></div><div><font color="#000000"><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">&lt;/</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">VirtualHost</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; font-size: 11pt;">&gt;</span></font></div><div><font color="#000000" style="font-size: 11pt;"><span style="font-family: &quot;DejaVu Sans Mono&quot;;"><br/></span></font></div><div><font color="#2D4FC9" face="DejaVu Sans Mono"><span style="font-size: 14.6667px;">##基于端口的虚拟主机</span></font></div><div><font color="#000000" style="font-size: 11pt;"><span style="font-family: &quot;DejaVu Sans Mono&quot;;">listen</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;;">8080</span></font></div><div><font color="#000000" style="font-size: 11pt;"><span style="font-family: &quot;DejaVu Sans Mono&quot;;">listen</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;;">8087</span></font></div><div><font style="font-size: 11pt;"><br style="font-family: &quot;DejaVu Sans Mono&quot;;"/></font></div><div><font color="#000000" style="font-size: 11pt;"><span style="font-family: &quot;DejaVu Sans Mono&quot;;">&lt;Directory</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;;">&quot;/var/www/www&quot;</span><span style="font-family: &quot;DejaVu Sans Mono&quot;;">&gt;</span></font></div><div><font color="#000000" style="font-size: 11pt;"><span style="font-family: &quot;DejaVu Sans Mono&quot;;">    </span> <span style="font-family: &quot;DejaVu Sans Mono&quot;;">Require</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;;">all</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;;">granted</span></font></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;;"><font color="#000000" style="font-size: 11pt;">&lt;/Directory&gt;</font></span></div><div><font style="font-size: 11pt;"><br style="font-family: &quot;DejaVu Sans Mono&quot;;"/></font></div><div><font color="#000000" style="font-size: 11pt;"><span style="font-family: &quot;DejaVu Sans Mono&quot;;">&lt;VirtualHost</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;;">*:8080</span><span style="font-family: &quot;DejaVu Sans Mono&quot;;">&gt;</span></font></div><div><font color="#000000" style="font-size: 11pt;"><span style="font-family: &quot;DejaVu Sans Mono&quot;;">   </span> <span style="font-family: &quot;DejaVu Sans Mono&quot;;">ServerName</span><span style="font-family: &quot;DejaVu Sans Mono&quot;;"><a href="http://www.lyucan.com/" style="color: rgb(0, 0, 0);">www.lyucan.com</a></span></font></div><div><font color="#000000" style="font-size: 11pt;"><span style="font-family: &quot;DejaVu Sans Mono&quot;;">   </span> <span style="font-family: &quot;DejaVu Sans Mono&quot;;">DocumentRoot</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;;">/var/www/www</span></font></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;;"><font color="#000000" style="font-size: 11pt;">&lt;/VirtualHost&gt;</font></span></div><div><font style="font-size: 11pt;"><br style="font-family: &quot;DejaVu Sans Mono&quot;;"/></font></div><div><font style="font-size: 11pt;"><br style="font-family: &quot;DejaVu Sans Mono&quot;;"/></font></div><div><font color="#000000" style="font-size: 11pt;"><span style="font-family: &quot;DejaVu Sans Mono&quot;;">&lt;Directory</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;;">&quot;/var/www/w&quot;</span><span style="font-family: &quot;DejaVu Sans Mono&quot;;">&gt;</span></font></div><div><font color="#000000" style="font-size: 11pt;"><span style="font-family: &quot;DejaVu Sans Mono&quot;;">    </span> <span style="font-family: &quot;DejaVu Sans Mono&quot;;">Require</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;;">all</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;;">granted</span></font></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;;"><font color="#000000" style="font-size: 11pt;">&lt;/Directory&gt;</font></span></div><div><font style="font-size: 11pt;"><br style="font-family: &quot;DejaVu Sans Mono&quot;;"/></font></div><div><font color="#000000" style="font-size: 11pt;"><span style="font-family: &quot;DejaVu Sans Mono&quot;;">&lt;VirtualHost</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;;">*:8087</span><span style="font-family: &quot;DejaVu Sans Mono&quot;;">&gt;</span></font></div><div><font color="#000000" style="font-size: 11pt;"><span style="font-family: &quot;DejaVu Sans Mono&quot;;">   </span> <span style="font-family: &quot;DejaVu Sans Mono&quot;;">ServerName</span><span style="font-family: &quot;DejaVu Sans Mono&quot;;"><a href="http://www.lyucan.com/" style="color: rgb(0, 0, 0);">www.lyucan.com</a></span></font></div><div><font color="#000000" style="font-size: 11pt;"><span style="font-family: &quot;DejaVu Sans Mono&quot;;">   </span> <span style="font-family: &quot;DejaVu Sans Mono&quot;;">DocumentRoot</span> <span style="font-family: &quot;DejaVu Sans Mono&quot;;">/var/www/w</span></font></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;;"><font color="#000000" style="font-size: 11pt;">&lt;/VirtualHost&gt;</font></span></div></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><div><br/></div></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">httpd -t 检查语法，<span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">重启服务生效</span></span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="font-size: 14px;">如果配置虚拟主机的时候，报错</span><span style="font-size: 11pt;"><span style="font-size: 11pt; color: rgb(227, 0, 0);">(13)Permission denied: AH00072: make_sock: could not bind to address 0.0.0.0:8089</span><span style="font-size: 11pt;">，则可能是selinux限制了端口，添加需要绑定的端口；</span></span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 11pt;"><span style="min-height: 10pt; font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">[root@lyucan conf.d]# yum -y install policycoreutils-python ##安装semanage工具</span></span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">[root@lyucan conf.d]# semanage port -l | grep http</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">http</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">_cache_port_t              tcp      8080, 8118, 8123, 10001-10010</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">http</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">_cache_port_t              udp      3130</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">http</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">_port_t                    tcp      80, 81, 443, 488, 8008, 8009, 8443, 9000</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">pegasus_</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">http</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">_port_t            tcp      5988</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">pegasus_</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">http</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">s_port_t           tcp      5989</span></div><div><br/></div><div><span style="min-height: 10pt; font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">[root@lyucan conf.d]# semanage port -a -t http_port_t -p tcp 8087</span></div><div><br/></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">[root@lyucan conf.d]# semanage port -l | grep http</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">http</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">_cache_port_t              tcp      8080, 8118, 8123, 10001-10010</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">http</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">_cache_port_t              udp      3130</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">http</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">_port_t                    tcp      <span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">8087</span>, 80, 81, 443, 488, 8008, 8009, 8443, 9000</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">pegasus_</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">http</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">_port_t            tcp      5988</span></div><div><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">pegasus_</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(187, 0, 0); font-size: 9pt;">http</span><span style="font-family: &quot;DejaVu Sans Mono&quot;; color: rgb(0, 128, 0); font-size: 9pt;">s_port_t           tcp      5989</span></div></div></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="font-size: 14px;">重启即可</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 18px; font-weight: bold; line-height: 1.75;">配置HTTPS,配置TLS</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">crypto-utils软件包包含一个名为genkey的命令，要使用genkey创建证书，运行genkey命令</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">[</span><a href="mailto:root@redhata" style="white-space: pre-wrap; font-size: 14px; color: rgb(0, 56, 132); line-height: 1.75; text-decoration: underline;">root@redhata</a><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;"> ~]# genkey &lt;FQDN&gt;（域名）</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">后面接的是客户端将用于连接服务器的完全限定域名</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">在创建期间，genkey将询问所需秘钥的大小，是否进行签名请求（回答“否”将创建自签名证书），是否应通过密语来保护私钥，以及有关服务器身份的常规信息。</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">在完成创建后，将生成多个文件</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">/etc/pki/tls/private/&lt;FQDN&gt;.key：这是私钥，应保持在0600或0400权限</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; background-color: rgb(255, 255, 255); line-height: 1.75;">/etc/pki/tls/certs/&lt;FQD</span><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">N&gt;.crt：这是公共证书。仅当请求自签名时，才会生成次文件。如果请求了签名求求并且将其发送到CA，那么这将是从CA返回的文件。</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; background-color: rgb(255, 255, 255); line-height: 1.75;">/etc/pki/tls/certs/&lt;FQDN&gt;.0.csr：这是请求签名时，才会生成次文件。这是发送到CA以进行签名的文件。永远不要把你的私钥发送到CA。</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">安装mod_ssl模块</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">yum -y install mod_ss</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">mod_wsgi   python cgi</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">开https端口</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">firewall-cmd --add-service https --permanent</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">firewall-cmd --reload</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">[</span><a href="mailto:root@redhata" style="white-space: pre-wrap; font-size: 14px; color: rgb(0, 56, 132); line-height: 1.75; text-decoration: underline;">root@redhata</a><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;"> ~]#vim /etc/httpd/conf.d/ssl.conf</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 11pt;">&lt;Directory &quot;/var/www/www&quot;&gt;</span></div><div><span style="font-size: 11pt;">     Require all granted</span></div><div><span style="font-size: 11pt;">&lt;/Directory&gt;</span></div><div><br style="font-size: 11pt;"/></div><div><span style="font-size: 11pt;">&lt;VirtualHost *:443&gt;</span></div><div><span style="font-size: 11pt;">ServerName</span> <a href="http://www.redhat.com/" style="font-size: 11pt;">www.redhat.com</a></div><div><span style="font-size: 11pt;">DocumentRoot /var/www/www</span></div><div><span style="font-size: 11pt;">ErrorLog logs/ssl_error_log</span></div><div><span style="font-size: 11pt;">TransferLog logs/ssl_access_log</span></div><div><span style="font-size: 11pt;">LogLevel warn</span></div><div><span style="font-size: 11pt;">SSLEngine on</span></div><div><span style="font-size: 11pt;">SSLProtocol all -SSLv2</span></div><div><span style="font-size: 11pt;">SSLCipherSuite HIGH:MEDIUM:!aNULL:!MD5</span></div><div><span style="font-size: 11pt;">SSLCertificateFile /etc/pki/tls/certs/</span><a href="http://www.redhat.com.crt/" style="font-size: 11pt;">www.redhat.com.crt</a></div><div><span style="font-size: 11pt;">SSLCertificateKeyFile /etc/pki/tls/private/</span><a href="http://www.redhat.com.key/" style="font-size: 11pt;">www.redhat.com.key</a></div><div><span style="font-size: 11pt;">&lt;/VirtualHost&gt;</span></div><div><br style="font-size: 11pt;"/></div><div><span style="font-size: 11pt;">为完成http到https的自动重定向，需要添加以下模块</span></div><div><span style="font-size: 11pt;">&lt;VirtualHost *:80&gt;</span></div><div><span style="font-size: 11pt;">ServerName</span> <a href="http://www.redhat.com/" style="font-size: 11pt;">www.redhat.com</a></div><div><span style="font-size: 11pt;">RewriteEngine on</span></div><div><span style="font-size: 11pt;">RewriteRule ^(/.*)$ https://%{HTTP_HOST}$1 [redirect=301]</span></div><div><span style="font-size: 11pt;">&lt;/VirtualHost&gt;</span></div></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">重启服务生效</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 18px; font-weight: bold; line-height: 1.75;">基于用户认证的网页登录</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">配置范例如下：</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 11pt;">&lt;Directory &quot;/var/www/kkk&quot;&gt;</span></div><div><span style="font-size: 11pt;">       Options none</span></div><div><span style="font-size: 11pt;">       AuthType Basic</span></div><div><span style="font-size: 11pt;">       AllowOverride AuthConfig</span></div><div><span style="font-size: 11pt;">       AuthName &quot;Restricted Site...&quot;</span></div><div><span style="font-size: 11pt;">       AuthUserFile &quot;/etc/httpd/conf/htpasswd&quot;</span></div><div><span style="font-size: 11pt;">       Require valid-user</span></div><div><span style="font-size: 11pt;">&lt;/Directory&gt;</span></div><div><br style="font-size: 11pt;"/></div><div><span style="font-size: 11pt;">&lt;VirtualHost *:80&gt;</span></div><div><span style="font-size: 11pt;">ServerName</span> <a href="http://www.kkk.com/" style="font-size: 11pt;">www.kkk.com</a></div><div><span style="font-size: 11pt;">DocumentRoot /var/www/kkk</span></div><div><span style="font-size: 11pt;">&lt;/VirtualHost&gt;</span></div></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">需要生成一个存储用户账号密码的配置文件</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-size: 11pt;">[root@redhata conf]# htpasswd -c -m /etc/httpd/conf/htpasswd lyn</span></div><div><span style="font-size: 11pt;">New password:</span></div><div><span style="font-size: 11pt;">Re-type new password:</span></div><div><span style="font-size: 11pt;">Adding password for user lyn</span></div></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; background-color: rgb(255, 255, 255); line-height: 1.75;">htpasswd 仅在第一次创建时需要加-c选项    -m添加用户    -D删除某一个用户</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">第二次添加用户时 直接 </span><span style="white-space: pre-wrap; font-size: 14px; background-color: rgb(255, 255, 255); line-height: 1.75;">[</span><a href="mailto:root@redhata" style="white-space: pre-wrap; font-size: 14px; background-color: rgb(255, 255, 255); color: rgb(0, 56, 132); line-height: 1.75; text-decoration: underline;">root@redhata</a><span style="white-space: pre-wrap; font-size: 14px; background-color: rgb(255, 255, 255); line-height: 1.75;"> conf]# htpasswd  /etc/httpd/conf/htpasswd lyn1 </span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; background-color: rgb(255, 255, 255); line-height: 1.75;">不用使参数</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">基于组认证的网页登录</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">将上面配置文件添加组配置文件且将Require字段配置为组认证</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; background-color: rgb(255, 255, 255); line-height: 1.75;">AuthGroupFile &quot;/etc/httpd/conf/htgroup&quot;</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; background-color: rgb(255, 255, 255); line-height: 1.75;">Require group mygroup</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; background-color: rgb(255, 255, 255); line-height: 1.75;">创建htgroup文件,添加用户进组，格式如下</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; background-color: rgb(255, 255, 255); line-height: 1.75;">mygroup：linus lyn （各个用户之间用空格隔开）k</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">然后将用户添加进组里面即可，而不再组里面的用户将不能登录网页</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">Require user 只允许某一个用户可以登录访问，而这些用户必须在身份配置文件中存在才行</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; color: rgb(255, 0, 0); line-height: 1.75;">MPM：多道处理模块 Multi Path Modules，定义一个站点在响应多个请求的工作模式</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; color: rgb(255, 0, 0); line-height: 1.75;">mpm_winnt Windows上的</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; color: rgb(255, 0, 0); line-height: 1.75;">prefork  预先生成进程，一个请求用一个进程响应，并发量大的时候性能较差，但稳定可靠，进程之间互不影响</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; color: rgb(255, 0, 0); line-height: 1.75;">work  生成多个进程，每个进程再生成多个线程，</span><span style="white-space: pre-wrap; font-size: 14px; background-color: rgb(255, 255, 255); color: rgb(255, 0, 0); line-height: 1.75;">一个请求用一个线程响应，并发量请求大的时候性能较好</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; color: rgb(255, 0, 0); line-height: 1.75;">event 一个进程响应多个请求</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;">url路径跟本地文件系统路径不一样，url是相对于DocumentRoot的路径而言的</span></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><br/></div><div style="white-space: pre-wrap; text-align: left; font-size: 14px;"><span style="white-space: pre-wrap; font-size: 14px; line-height: 1.75;"> </span></div><div><br/></div></span>
</div></body></html> 