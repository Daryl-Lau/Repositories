<html>
<head>
  <title>Linux下用netstat命令查看网络负载状况</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="497"/>
<h1>Linux下用netstat命令查看网络负载状况</h1>

<div>
<span><div><h6 style="outline: 0px; padding: 0px; margin: 0px; font-size: 24px; word-break: break-all;"><span style="outline: 0px; font-size: 24px; word-break: break-all;">Linux下用netstat命令查看网络负载状况</span></h6><h6 style="outline: 0px; padding: 0px; margin: 0px; font-size: 24px; word-break: break-all;"><span style="outline: 0px; font-size: 24px; word-break: break-all;"><br/></span></h6></div><div style="box-sizing: inherit; outline: 0px; padding: 0px; margin: 0px; font-family: &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, SimHei, Arial, SimSun; word-break: break-all;"><div style="box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 14px; color: rgb(51, 51, 51); line-height: 22.4px; text-align: justify; word-break: break-all; font-family: tahoma, 宋体; background-color: rgb(250, 250, 252);"><span style="box-sizing: border-box; outline: 0px; font-size: 14px; color: rgb(51, 51, 51); line-height: 22.4px; word-break: break-all; font-family: tahoma, 宋体; background-color: rgb(250, 250, 252);">今天看到一条用 netstat 查看 Linux 网络状况的语句，如下：</span></div><div style="box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 14px; color: rgb(51, 51, 51); line-height: 22.4px; text-align: justify; word-break: break-all; font-family: tahoma, 宋体; background-color: rgb(250, 250, 252);"><span style="box-sizing: border-box; outline: 0px; font-size: 14px; color: rgb(0, 204, 34); font-weight: bold; line-height: 22.4px; word-break: break-all; font-family: tahoma, 宋体; background-color: rgb(250, 250, 252);">netstat -n | awk '/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}'</span></div><div style="box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 14px; color: rgb(51, 51, 51); line-height: 22.4px; text-align: justify; word-break: break-all; font-family: tahoma, 宋体; background-color: rgb(250, 250, 252);"><span style="box-sizing: border-box; outline: 0px; font-size: 14px; color: rgb(51, 51, 51); line-height: 22.4px; word-break: break-all; font-family: tahoma, 宋体; background-color: rgb(250, 250, 252);">前面的 netstat -n是netstat的命令，Windows和Linux都可以用，结果显示内容差不多</span></div><div style="box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 14px; color: rgb(51, 51, 51); line-height: 22.4px; text-align: justify; word-break: break-all; font-family: tahoma, 宋体; background-color: rgb(250, 250, 252);"><span style="box-sizing: border-box; outline: 0px; font-size: 14px; color: rgb(51, 51, 51); line-height: 22.4px; word-break: break-all; font-family: tahoma, 宋体; background-color: rgb(250, 250, 252);">后面的 awk'/^tcp/ {++S[$NF]} END {for(a in S) print a, S[a]}' 是Linux下的命令，主要作用是对netstat输出的结果进行过滤和处理</span></div><div style="box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 14px; color: rgb(51, 51, 51); line-height: 22.4px; text-align: justify; word-break: break-all; font-family: tahoma, 宋体; background-color: rgb(250, 250, 252);"><span style="box-sizing: border-box; outline: 0px; font-size: 14px; color: rgb(51, 51, 51); line-height: 22.4px; word-break: break-all; font-family: tahoma, 宋体; background-color: rgb(250, 250, 252);">运行这一句之后，显示的结果类似如下：</span></div><p style="box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 14px; color: rgb(51, 51, 51); font-weight: 400; line-height: 22.4px; text-align: justify; word-break: break-all; font-family: tahoma, 宋体; background-color: rgb(250, 250, 252);"></p><div><span style="box-sizing: border-box; outline: 0px; word-break: break-all; background-color: rgb(217, 255, 255);">TIME_WAIT 27       </span></div><div><span style="box-sizing: border-box; outline: 0px; word-break: break-all; background-color: rgb(217, 255, 255);">FIN_WAIT1 435</span></div><div><span style="box-sizing: border-box; outline: 0px; word-break: break-all; background-color: rgb(217, 255, 255);">FIN_WAIT2 89</span></div><div><span style="box-sizing: border-box; outline: 0px; word-break: break-all; background-color: rgb(217, 255, 255);">ESTABLISHED 82</span></div><div><span style="box-sizing: border-box; outline: 0px; word-break: break-all; background-color: rgb(217, 255, 255);">SYN_RECV 64</span></div><div><span style="box-sizing: border-box; outline: 0px; word-break: break-all; background-color: rgb(217, 255, 255);">CLOSING 4</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="box-sizing: border-box; outline: 0px; word-break: break-all; background-color: rgb(217, 255, 255);-en-paragraph:true;">LAST_ACK 90</span></div><div style="box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 14px; color: rgb(51, 51, 51); line-height: 22.4px; text-align: justify; word-break: break-all; font-family: tahoma, 宋体; background-color: rgb(250, 250, 252);"><span style="box-sizing: border-box; outline: 0px; font-size: 14px; color: rgb(51, 51, 51); line-height: 22.4px; word-break: break-all; font-family: tahoma, 宋体; background-color: rgb(250, 250, 252);">这些结果代表啥意思呢？如下：</span></div><p style="box-sizing: border-box; outline: 0px; padding: 0px; margin: 0px 0px 16px; font-size: 14px; color: rgb(51, 51, 51); font-weight: 400; line-height: 22.4px; text-align: justify; word-break: break-all; font-family: tahoma, 宋体; background-color: rgb(250, 250, 252);"></p><div><span style="font-weight: bold; box-sizing: border-box; outline: 0px; word-break: break-all;">TIME-WAIT</span>：等待足够的时间以确保远程TCP接收到连接中断请求的确认</div><div><span style="font-weight: bold; box-sizing: border-box; outline: 0px; word-break: break-all;">FIN-WAIT-1</span>：等待远程TCP连接中断请求，或先前的连接中断请求的确认</div><div><span style="font-weight: bold; box-sizing: border-box; outline: 0px; word-break: break-all;">FIN-WAIT-2</span>：从远程TCP等待连接中断请求</div><div><span style="font-weight: bold; box-sizing: border-box; outline: 0px; word-break: break-all;">ESTABLISHED</span>：代表一个打开的连接</div><div><span style="font-weight: bold; box-sizing: border-box; outline: 0px; word-break: break-all;">SYN-RECV</span>：再收到和发送一个连接请求后等待对方对连接请求的确认</div><div><span style="font-weight: bold; box-sizing: border-box; outline: 0px; word-break: break-all;">SYN-SENT</span>：再发送连接请求后等待匹配的连接请求</div><div><span style="font-weight: bold; box-sizing: border-box; outline: 0px; word-break: break-all;">CLOSING</span>：等待远程TCP对连接中断的确认</div><div><span style="font-weight: bold; box-sizing: border-box; outline: 0px; word-break: break-all;">CLOSED</span>：没有任何连接状态</div><div><span style="font-weight: bold; box-sizing: border-box; outline: 0px; word-break: break-all;">CLOSE-WAIT</span>：等待从本地用户发来的连接中断请求</div><div><span style="font-weight: bold; box-sizing: border-box; outline: 0px; word-break: break-all;">LAST-ACK</span>：等待原来的发向远程TCP的连接中断请求的确认</div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-weight: bold; box-sizing: border-box; outline: 0px; word-break: break-all;-en-paragraph:true;">LISTEN</span><span style="-en-paragraph:true;">：侦听来自远方的TCP端口的连接请求</span></div></div><div><br/></div></span>
</div></body></html> 